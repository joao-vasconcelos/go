export default function getStopsDistance() {
  const stops = [
    { lat: 38.69827, lon: -9.22764 },
    { lat: 38.69622, lon: -9.19834 },
    { lat: 38.70287, lon: -9.17324 },
    { lat: 38.7062, lon: -9.15573 },
    { lat: 38.70533, lon: -9.14394 },
  ];

  const shape = [
    { lat: 38.70538, lon: -9.14389 },
    { lat: 38.70536, lon: -9.14387 },
    { lat: 38.70534, lon: -9.14383 },
    { lat: 38.70532, lon: -9.14378 },
    { lat: 38.70532, lon: -9.14373 },
    { lat: 38.70532, lon: -9.14357 },
    { lat: 38.70532, lon: -9.14336 },
    { lat: 38.70533, lon: -9.14331 },
    { lat: 38.70535, lon: -9.14327 },
    { lat: 38.70537, lon: -9.14325 },
    { lat: 38.70539, lon: -9.14324 },
    { lat: 38.70543, lon: -9.14323 },
    { lat: 38.70551, lon: -9.14322 },
    { lat: 38.70565, lon: -9.14322 },
    { lat: 38.70574, lon: -9.14322 },
    { lat: 38.70584, lon: -9.14321 },
    { lat: 38.70598, lon: -9.14321 },
    { lat: 38.70618, lon: -9.1432 },
    { lat: 38.70622, lon: -9.14321 },
    { lat: 38.70624, lon: -9.14321 },
    { lat: 38.70623, lon: -9.14323 },
    { lat: 38.70622, lon: -9.14327 },
    { lat: 38.70621, lon: -9.14331 },
    { lat: 38.7062, lon: -9.1434 },
    { lat: 38.70619, lon: -9.14349 },
    { lat: 38.70619, lon: -9.14358 },
    { lat: 38.7062, lon: -9.14369 },
    { lat: 38.70622, lon: -9.14386 },
    { lat: 38.70626, lon: -9.14422 },
    { lat: 38.70626, lon: -9.14424 },
    { lat: 38.70627, lon: -9.14438 },
    { lat: 38.70628, lon: -9.14482 },
    { lat: 38.70628, lon: -9.1449 },
    { lat: 38.70628, lon: -9.14504 },
    { lat: 38.70629, lon: -9.14533 },
    { lat: 38.7063, lon: -9.14599 },
    { lat: 38.70633, lon: -9.14731 },
    { lat: 38.70634, lon: -9.14816 },
    { lat: 38.70635, lon: -9.14855 },
    { lat: 38.70636, lon: -9.14883 },
    { lat: 38.70636, lon: -9.14911 },
    { lat: 38.70639, lon: -9.15077 },
    { lat: 38.70639, lon: -9.15089 },
    { lat: 38.70641, lon: -9.15254 },
    { lat: 38.70644, lon: -9.15347 },
    { lat: 38.70645, lon: -9.15406 },
    { lat: 38.70645, lon: -9.15424 },
    { lat: 38.70645, lon: -9.1544 },
    { lat: 38.70644, lon: -9.15456 },
    { lat: 38.70642, lon: -9.15487 },
    { lat: 38.70642, lon: -9.15491 },
    { lat: 38.70641, lon: -9.15501 },
    { lat: 38.7064, lon: -9.15511 },
    { lat: 38.70638, lon: -9.15519 },
    { lat: 38.70636, lon: -9.15529 },
    { lat: 38.70631, lon: -9.15557 },
    { lat: 38.70625, lon: -9.15577 },
    { lat: 38.70622, lon: -9.15588 },
    { lat: 38.70619, lon: -9.15597 },
    { lat: 38.70615, lon: -9.15605 },
    { lat: 38.70612, lon: -9.15613 },
    { lat: 38.7058, lon: -9.15679 },
    { lat: 38.70534, lon: -9.15776 },
    { lat: 38.70514, lon: -9.15818 },
    { lat: 38.70464, lon: -9.15926 },
    { lat: 38.70437, lon: -9.1599 },
    { lat: 38.70423, lon: -9.16032 },
    { lat: 38.70407, lon: -9.16083 },
    { lat: 38.704, lon: -9.16116 },
    { lat: 38.70374, lon: -9.16237 },
    { lat: 38.70373, lon: -9.16246 },
    { lat: 38.70366, lon: -9.16276 },
    { lat: 38.7036, lon: -9.16312 },
    { lat: 38.70355, lon: -9.16343 },
    { lat: 38.70353, lon: -9.1637 },
    { lat: 38.70352, lon: -9.16388 },
    { lat: 38.70351, lon: -9.16406 },
    { lat: 38.7035, lon: -9.16449 },
    { lat: 38.70351, lon: -9.16706 },
    { lat: 38.7035, lon: -9.16745 },
    { lat: 38.7035, lon: -9.16772 },
    { lat: 38.7035, lon: -9.16786 },
    { lat: 38.703405, lon: -9.171761 },
    { lat: 38.70342, lon: -9.17174 },
    { lat: 38.70336, lon: -9.172 },
    { lat: 38.70327, lon: -9.17225 },
    { lat: 38.70319, lon: -9.17258 },
    { lat: 38.70314, lon: -9.17278 },
    { lat: 38.70308, lon: -9.17298 },
    { lat: 38.70302, lon: -9.17318 },
    { lat: 38.70297, lon: -9.17332 },
    { lat: 38.70296, lon: -9.17335 },
    { lat: 38.70288, lon: -9.17356 },
    { lat: 38.70279, lon: -9.17378 },
    { lat: 38.70276, lon: -9.17405 },
    { lat: 38.70274, lon: -9.17454 },
    { lat: 38.70273, lon: -9.17472 },
    { lat: 38.70271, lon: -9.17486 },
    { lat: 38.7027, lon: -9.17491 },
    { lat: 38.70266, lon: -9.17504 },
    { lat: 38.70262, lon: -9.17512 },
    { lat: 38.70257, lon: -9.1752 },
    { lat: 38.70252, lon: -9.17526 },
    { lat: 38.70244, lon: -9.17532 },
    { lat: 38.70233, lon: -9.17541 },
    { lat: 38.70202, lon: -9.17566 },
    { lat: 38.70175, lon: -9.17594 },
    { lat: 38.7013, lon: -9.1765 },
    { lat: 38.70116, lon: -9.17678 },
    { lat: 38.70107, lon: -9.17694 },
    { lat: 38.70066, lon: -9.17776 },
    { lat: 38.70046, lon: -9.17817 },
    { lat: 38.70039, lon: -9.17831 },
    { lat: 38.70027, lon: -9.17856 },
    { lat: 38.70019, lon: -9.17872 },
    { lat: 38.70012, lon: -9.17885 },
    { lat: 38.69976, lon: -9.17961 },
    { lat: 38.69945, lon: -9.18033 },
    { lat: 38.69924, lon: -9.18086 },
    { lat: 38.69914, lon: -9.18111 },
    { lat: 38.69892, lon: -9.18171 },
    { lat: 38.69881, lon: -9.18207 },
    { lat: 38.69851, lon: -9.183 },
    { lat: 38.69848, lon: -9.1831 },
    { lat: 38.69847, lon: -9.18316 },
    { lat: 38.69837, lon: -9.18351 },
    { lat: 38.69823, lon: -9.18406 },
    { lat: 38.69803, lon: -9.18491 },
    { lat: 38.69784, lon: -9.18585 },
    { lat: 38.69773, lon: -9.18653 },
    { lat: 38.69768, lon: -9.18692 },
    { lat: 38.69759, lon: -9.18754 },
    { lat: 38.69758, lon: -9.18765 },
    { lat: 38.69756, lon: -9.18779 },
    { lat: 38.69753, lon: -9.18798 },
    { lat: 38.69752, lon: -9.18805 },
    { lat: 38.69748, lon: -9.18825 },
    { lat: 38.6974, lon: -9.1887 },
    { lat: 38.69731, lon: -9.18913 },
    { lat: 38.69688, lon: -9.19178 },
    { lat: 38.69682, lon: -9.19216 },
    { lat: 38.69671, lon: -9.19294 },
    { lat: 38.69664, lon: -9.19351 },
    { lat: 38.69658, lon: -9.19426 },
    { lat: 38.69656, lon: -9.19449 },
    { lat: 38.69645, lon: -9.19639 },
    { lat: 38.69642, lon: -9.19683 },
    { lat: 38.69641, lon: -9.19694 },
    { lat: 38.69638, lon: -9.19738 },
    { lat: 38.69636, lon: -9.19766 },
    { lat: 38.69634, lon: -9.1978 },
    { lat: 38.69632, lon: -9.19805 },
    { lat: 38.69629, lon: -9.19836 },
    { lat: 38.69627, lon: -9.19856 },
    { lat: 38.69622, lon: -9.19893 },
    { lat: 38.69619, lon: -9.19908 },
    { lat: 38.69614, lon: -9.19934 },
    { lat: 38.69613, lon: -9.1994 },
    { lat: 38.69591, lon: -9.2006 },
    { lat: 38.69586, lon: -9.20084 },
    { lat: 38.69569, lon: -9.20178 },
    { lat: 38.69552, lon: -9.20274 },
    { lat: 38.69531, lon: -9.20386 },
    { lat: 38.6952, lon: -9.20448 },
    { lat: 38.69502, lon: -9.20545 },
    { lat: 38.69487, lon: -9.20631 },
    { lat: 38.69486, lon: -9.20635 },
    { lat: 38.69481, lon: -9.20662 },
    { lat: 38.69476, lon: -9.20703 },
    { lat: 38.69475, lon: -9.20712 },
    { lat: 38.69462, lon: -9.20769 },
    { lat: 38.69455, lon: -9.20811 },
    { lat: 38.69444, lon: -9.20863 },
    { lat: 38.69439, lon: -9.20892 },
    { lat: 38.69433, lon: -9.20945 },
    { lat: 38.69424, lon: -9.21044 },
    { lat: 38.69407, lon: -9.21222 },
    { lat: 38.69407, lon: -9.21224 },
    { lat: 38.69407, lon: -9.21229 },
    { lat: 38.69383, lon: -9.2149 },
    { lat: 38.69381, lon: -9.21521 },
    { lat: 38.69379, lon: -9.21543 },
    { lat: 38.69377, lon: -9.21562 },
    { lat: 38.69376, lon: -9.21575 },
    { lat: 38.69373, lon: -9.2161 },
    { lat: 38.69367, lon: -9.21684 },
    { lat: 38.69366, lon: -9.21697 },
    { lat: 38.69364, lon: -9.21728 },
    { lat: 38.69365, lon: -9.21761 },
    { lat: 38.69368, lon: -9.21789 },
    { lat: 38.69373, lon: -9.21818 },
    { lat: 38.69395, lon: -9.21891 },
    { lat: 38.69435, lon: -9.22015 },
    { lat: 38.69439, lon: -9.22028 },
    { lat: 38.69445, lon: -9.22047 },
    { lat: 38.69456, lon: -9.22083 },
    { lat: 38.69462, lon: -9.22101 },
    { lat: 38.69476, lon: -9.22136 },
    { lat: 38.69491, lon: -9.22168 },
    { lat: 38.69503, lon: -9.22192 },
    { lat: 38.69561, lon: -9.22293 },
    { lat: 38.69714, lon: -9.22564 },
    { lat: 38.69729, lon: -9.2259 },
    { lat: 38.69754, lon: -9.22593 },
    { lat: 38.69758, lon: -9.22589 },
    { lat: 38.69764, lon: -9.22584 },
    { lat: 38.69774, lon: -9.22576 },
    { lat: 38.6978, lon: -9.2257 },
    { lat: 38.69785, lon: -9.22566 },
    { lat: 38.69788, lon: -9.22564 },
    { lat: 38.69795, lon: -9.22559 },
    { lat: 38.698, lon: -9.22556 },
    { lat: 38.69806, lon: -9.22552 },
    { lat: 38.69811, lon: -9.22549 },
    { lat: 38.69818, lon: -9.22546 },
    { lat: 38.6982, lon: -9.22545 },
    { lat: 38.69823, lon: -9.22543 },
    { lat: 38.69829, lon: -9.22541 },
    { lat: 38.6984, lon: -9.22537 },
    { lat: 38.69843, lon: -9.22536 },
    { lat: 38.69861, lon: -9.22535 },
    { lat: 38.69873, lon: -9.22537 },
    { lat: 38.69884, lon: -9.22539 },
    { lat: 38.69895, lon: -9.22542 },
    { lat: 38.69907, lon: -9.22546 },
    { lat: 38.69917, lon: -9.22552 },
    { lat: 38.69925, lon: -9.22558 },
    { lat: 38.69924, lon: -9.22559 },
    { lat: 38.6992, lon: -9.22569 },
    { lat: 38.69904, lon: -9.22605 },
    { lat: 38.69892, lon: -9.22634 },
    { lat: 38.69888, lon: -9.22648 },
    { lat: 38.69885, lon: -9.22662 },
    { lat: 38.69883, lon: -9.22678 },
    { lat: 38.69883, lon: -9.22679 },
    { lat: 38.69881, lon: -9.22692 },
    { lat: 38.69881, lon: -9.22699 },
    { lat: 38.69881, lon: -9.22704 },
    { lat: 38.69882, lon: -9.2271 },
    { lat: 38.69882, lon: -9.22718 },
    { lat: 38.69884, lon: -9.22725 },
    { lat: 38.69885, lon: -9.2273 },
    { lat: 38.69888, lon: -9.2274 },
    { lat: 38.69888, lon: -9.22743 },
    { lat: 38.69888, lon: -9.22745 },
    { lat: 38.69888, lon: -9.22747 },
    { lat: 38.69887, lon: -9.22749 },
    { lat: 38.69886, lon: -9.2275 },
    { lat: 38.69879, lon: -9.22754 },
  ];

  console.log(calculateStopDistances(stops, shape));
}

function calculateStopDistances(stops, shapePoints) {
  let distances = [];
  for (let i = 0; i < stops.length - 1; i++) {
    const stopA = stops[i];
    const stopB = stops[i + 1];
    let distance = 0;
    let closestShapePoint = null;
    for (let j = 0; j < shapePoints.length - 1; j++) {
      const shapePointA = shapePoints[j];
      const shapePointB = shapePoints[j + 1];
      const segmentDistance = haversine(shapePointA.lat, shapePointA.lon, shapePointB.lat, shapePointB.lon);
      const distanceA = haversine(stopA.lat, stopA.lon, shapePointA.lat, shapePointA.lon);
      const distanceB = haversine(stopB.lat, stopB.lon, shapePointB.lat, shapePointB.lon);
      console.log('-------------------------');
      console.log('segmentDistance', segmentDistance);
      console.log('distanceA + distanceB', distanceA + distanceB);
      console.log('distanceA + distanceB <= segmentDistance', distanceA + distanceB <= segmentDistance);
      if (distanceA - distanceB <= segmentDistance) {
        // found the closest segment to both stops
        const segmentRatio = (distanceA + distanceB) / segmentDistance;
        distance = segmentRatio * (shapePointB.dist - shapePointA.dist) + shapePointA.dist;
        closestShapePoint = shapePointA;
        break;
      }
    }
    distances.push({
      stopA,
      stopB,
      distance,
      shapePoint: closestShapePoint,
    });
  }
  return distances;
}

function haversine(lat1, lon1, lat2, lon2) {
  const R = 6371e3; // Earth's radius in meters
  const lat1Rad = toRadians(lat1);
  const lat2Rad = toRadians(lat2);
  const latDelta = toRadians(lat2 - lat1);
  const lonDelta = toRadians(lon2 - lon1);

  const a = Math.sin(latDelta / 2) * Math.sin(latDelta / 2) + Math.cos(lat1Rad) * Math.cos(lat2Rad) * Math.sin(lonDelta / 2) * Math.sin(lonDelta / 2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

  return R * c;
}

function toRadians(degrees) {
  return (degrees * Math.PI) / 180;
}
